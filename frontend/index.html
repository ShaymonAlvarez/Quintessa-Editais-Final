<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Busca de editais</title>
    <link rel="stylesheet" href="/static/styles.css?v=qs-roxo-2">
    <style>
      .tab-panel{display:none;}
      .tab-panel.active{display:block;}
    </style>
  </head>
  <body class="collect-theme">
    <header class="app-header">
      <h1>Automa√ß√£o de Editais - Quintessa</h1>
    </header>

    <main class="app-main">
      <nav class="tabs-nav">
        <button class="tab-btn active" data-tab="manage">Coleta e gest√£o</button>
        <button class="nav-btn btn-logout" onclick="window.location.href='/api/logout'">Fazer logout</button>
      </nav>

      <section id="tab-manage" class="tab-panel active">
        <div class="collect-layout">
          <aside class="collect-sidebar">
            <div class="qs-logo">
              <img src="/static/logo2.png" alt="QUINTESSA" />
            </div>

            <nav class="side-actions">
              <button class="side-cta" onclick="window.location.href='/'">P√ÅGINA INICIAL</button>
              <a class="side-cta" href="https://docs.google.com/spreadsheets/d/1icM3zgqrcRLS_Lu2ug849N2hiUcYJNgWQPpxQXRILvE/edit?usp=sharing" target="_blank" rel="noopener">IR PARA PLANILHA</a>
            </nav>
          </aside>

          <div class="collect-content">
            <header class="collect-hero">
                <h2 style="text-align: center;">BUSCA E COLETA</h2>
            </header>

            <section class="collect-toolbar" id="new-toolbar">
              
              <div class="filter-column">
                <div class="form-title">FILTRAR POR:</div>
                
                <div class="form-group">
                  <label for="filter-data-new">Data:</label>
                  <input type-="text" id="filter-data-new" class="form-control" placeholder="dd/mm/aaaa" />
                </div>
                
                <div class="form-group">
                  <label for="filter-valor-new">Valor:</label>
                  <input type="text" id="filter-valor-new" class="form-control" placeholder="de 0 at√© 5mil reais" />
                </div>
                
                <div class="form-group">
                  <label for="filter-prazo-new">Encerramento em:</label>
                  <select id="filter-prazo-new" class="form-control">
                    <option value="10">10 dias</option>
                    <option value="7">7 dias</option>
                    <option value="15">15 dias</option>
                    <option value="30">30 dias ou +</option>
                  </select>
                </div>
                
                <button id="btn-save-min-days" class="pill-btn pill-muted">Salvar Prazo</button>
              </div>
              
              <div class="groups-column">
                <div class="groups-title">ü§ñ COLETA VIA IA</div>
                <div class="groups-info">
                  <p>A coleta processa automaticamente todos os <strong>links ativos</strong> cadastrados abaixo.</p>
                  <p>Gerencie os links na se√ß√£o abaixo.</p>
                </div>
              </div>
              
              <div class="actions-column">
                <button id="btn-diag" class="pill-btn pill-diag">DIAGN√ìSTICO</button>
                <button id="btn-clear-all" class="pill-btn pill-danger">RESETAR PLANILHA</button>
                <button id="btn-run-collect" class="pill-btn pill-success">RODAR COLETA</button>
                
                <button id="btn-refresh-items" class="pill-btn pill-refresh">RECARREGAR ITENS</button>
              </div>
              
            </section>
            <input type="date" id="filter-date" class="visually-hidden-date" />

            <!-- SE√á√ÉO DE LINKS CADASTRADOS (COLETA UNIVERSAL) -->
            <section id="links-section" class="links-section">
              <div class="links-header">
                <h3>üîó LINKS CADASTRADOS PARA COLETA</h3>
                <button id="btn-toggle-links-form" class="pill-btn pill-muted">+ Adicionar Link</button>
              </div>
              
              <div id="links-form" class="links-form hidden">
                <div class="links-form-row">
                  <div class="form-group">
                    <label for="new-link-url">URL do site:</label>
                    <input type="text" id="new-link-url" class="form-control" placeholder="https://..." />
                  </div>
                  <div class="form-group">
                    <label for="new-link-grupo">Grupo:</label>
                    <select id="new-link-grupo" class="form-control">
                      <!-- Preenchido via JS -->
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="new-link-nome">Nome/Apelido (opcional):</label>
                    <input type="text" id="new-link-nome" class="form-control" placeholder="Ex: FINEP Inova√ß√£o" />
                  </div>
                  <div class="form-group form-actions">
                    <button id="btn-save-link" class="pill-btn pill-success">Salvar Link</button>
                    <button id="btn-cancel-link" class="pill-btn pill-muted">Cancelar</button>
                  </div>
                </div>
              </div>
              
              <div id="links-list" class="links-list">
                <em>Carregando links cadastrados...</em>
              </div>
              
              <div class="links-info">
                <small>
                  üí° Cadastre links de p√°ginas que listam editais. 
                  Ao clicar em "RODAR COLETA", o sistema usar√° IA para extrair automaticamente os editais de cada link.
                </small>
              </div>
            </section>

            <div id="collect-progress" class="progress-overlay hidden">
              <div class="progress-box">
                <span id="collect-progress-label" class="progress-label">Preparando coleta‚Ä¶</span>
                <progress id="collect-progress-bar" value="0" max="1"></progress>
                <button id="btn-cancel-collect" class="danger" data-keep-enabled="true">Cancelar coleta</button>
              </div>
            </div>

            <div id="collect-result"></div>

            <section id="diag-section" class="hidden">
              <h2>Diagn√≥stico dos providers</h2>
              <div class="diag-filters">
                <div>
                  <label>Regex Governo/Multilaterais</label>
                  <input id="diag-re-gov" type="text" />
                </div>

              <div>
                  <label>Regex Funda√ß√µes e Pr√™mios</label>
                  <input id="diag-re-gov" type="text" />
              </div>


              <div>
                <label>Regex Corporativo/Aceleradoras</label>
                <input id="diag-re-latam" type="text" />
              </div>
              
              <button id="btn-run-diag">Rodar diagn√≥stico</button>
              </div>

              <div id="diag-progress" class="progress-overlay hidden">
                <div class="progress-box">
                  <span id="diag-progress-label" class="progress-label">Preparando diagn√≥stico‚Ä¶</span>
                  <progress id="diag-progress-bar"></progress>
                  <button id="btn-cancel-diag" class="danger" data-keep-enabled="true">Cancelar diagn√≥stico</button>
                </div>
              </div>

              <div id="diag-results"></div>
            </section>

            <section id="groups-container"></section>

            <section id="errors-section" class="hidden">
              <h2>Erros desta execu√ß√£o</h2>
              <div id="errors-list"></div>
            </section>
          </div>
        </div>

        <div id="value-modal" class="modal hidden">
          <div class="modal-card">
            <h3>Filtrar por valor (R$)</h3>
            <label class="modal-row">
              M√°ximo:
              <input type="number" id="value-max" min="0" step="100" placeholder="5000" />
            </label>
            <div class="modal-actions">
              <button id="value-cancel">Cancelar</button>
              <button id="value-apply" class="primary">Aplicar</button>
            </div>
          </div>
        </div>
      </section>

      </section>
    </main>

    <script src="/static/app.js?v=qs-roxo-2"></script>
  </body>
</html>